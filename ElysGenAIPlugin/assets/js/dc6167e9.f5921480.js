"use strict";(globalThis.webpackChunkelysgenai_docs=globalThis.webpackChunkelysgenai_docs||[]).push([[960],{50(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"MultiplayerGuide","title":"Multiplayer Guide","description":"Designing multiplayer-safe GenAI systems with ElysGenAI.","source":"@site/../Documentation/MultiplayerGuide.md","sourceDirName":".","slug":"/MultiplayerGuide","permalink":"/ElysGenAIPlugin/MultiplayerGuide","draft":false,"unlisted":false,"editUrl":"https://github.com/RogueParadigm/ElysGenAIPlugin/tree/main/Documentation/../Documentation/MultiplayerGuide.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"id":"MultiplayerGuide","title":"Multiplayer Guide","sidebar_position":7},"sidebar":"docsSidebar","previous":{"title":"API Reference","permalink":"/ElysGenAIPlugin/API-Reference"},"next":{"title":"Troubleshooting","permalink":"/ElysGenAIPlugin/Troubleshooting"}}');var r=i(4848),t=i(8453);const s={id:"MultiplayerGuide",title:"Multiplayer Guide",sidebar_position:7},o="Multiplayer Guide",a={},c=[{value:"Core Principle",id:"core-principle",level:2},{value:"Architecture Rules",id:"architecture-rules",level:2},{value:"What Runs on Client",id:"what-runs-on-client",level:3},{value:"What Runs on Server",id:"what-runs-on-server",level:3},{value:"Never Replicate",id:"never-replicate",level:3},{value:"Always Replicate",id:"always-replicate",level:3},{value:"Network Mode Check",id:"network-mode-check",level:2},{value:"Voice Command Pattern",id:"voice-command-pattern",level:2},{value:"Bandwidth Efficiency",id:"bandwidth-efficiency",level:2},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Command Validation",id:"command-validation",level:3},{value:"Anti-Cheat",id:"anti-cheat",level:3},{value:"NPC Dialogue",id:"npc-dialogue",level:2},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Pattern 1: Client STT \u2192 Server Processing",id:"pattern-1-client-stt--server-processing",level:3},{value:"Pattern 2: Server LLM \u2192 Client Display",id:"pattern-2-server-llm--client-display",level:3},{value:"Pattern 3: Client STT + Client LLM",id:"pattern-3-client-stt--client-llm",level:3},{value:"Testing Multiplayer",id:"testing-multiplayer",level:2},{value:"Test in Editor",id:"test-in-editor",level:3},{value:"Verify Behavior",id:"verify-behavior",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"multiplayer-guide",children:"Multiplayer Guide"})}),"\n",(0,r.jsx)(n.p,{children:"Designing multiplayer-safe GenAI systems with ElysGenAI."}),"\n",(0,r.jsx)(n.h2,{id:"core-principle",children:"Core Principle"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Audio processing is CLIENT-SIDE ONLY"})}),"\n",(0,r.jsx)(n.p,{children:"Never replicate raw audio over the network. Only replicate text results and metadata."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"architecture-rules",children:"Architecture Rules"}),"\n",(0,r.jsx)(n.h3,{id:"what-runs-on-client",children:"What Runs on Client"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Audio capture (microphone)"}),"\n",(0,r.jsx)(n.li,{children:"Speech-to-text processing"}),"\n",(0,r.jsx)(n.li,{children:"LLM generation (for player assistance)"}),"\n",(0,r.jsx)(n.li,{children:"Voice activity detection"}),"\n",(0,r.jsx)(n.li,{children:"Audio buffering"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"what-runs-on-server",children:"What Runs on Server"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Text processing (from STT results)"}),"\n",(0,r.jsx)(n.li,{children:"Intent parsing"}),"\n",(0,r.jsx)(n.li,{children:"Command validation"}),"\n",(0,r.jsx)(n.li,{children:"Game state changes"}),"\n",(0,r.jsx)(n.li,{children:"NPC dialogue generation (LLM)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"never-replicate",children:"Never Replicate"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Raw audio data (TArray<float>)"}),"\n",(0,r.jsx)(n.li,{children:"Audio buffers"}),"\n",(0,r.jsx)(n.li,{children:"Model inference results (internal)"}),"\n",(0,r.jsx)(n.li,{children:"Backend instances"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"always-replicate",children:"Always Replicate"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Transcribed text (FString)"}),"\n",(0,r.jsx)(n.li,{children:"Parsed intents"}),"\n",(0,r.jsx)(n.li,{children:"Command confirmations"}),"\n",(0,r.jsx)(n.li,{children:"NPC responses"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"network-mode-check",children:"Network Mode Check"}),"\n",(0,r.jsx)(n.p,{children:"Check network mode before processing audio:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'void UERP_STTComponent::BeginPlay()\n{\n    Super::BeginPlay();\n    \n    // Only process audio on owning client\n    if (GetNetMode() == NM_DedicatedServer)\n    {\n        UE_LOG(LogElysSTT, Warning, \n            TEXT("STT on dedicated server - disabled"));\n        return;\n    }\n    \n    if (!GetOwner()->HasAuthority() || GetOwner()->IsLocallyControlled())\n    {\n        StartListening();\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Network Modes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NM_Standalone:"})," Single player - audio capture enabled"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NM_ListenServer:"})," Host + client - audio capture on locally controlled only"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NM_DedicatedServer:"})," Server only - NO audio capture"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"NM_Client:"})," Connected client - audio capture on locally controlled only"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"voice-command-pattern",children:"Voice Command Pattern"}),"\n",(0,r.jsx)(n.p,{children:"Complete example showing client-side processing with server validation:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'// PlayerController.h\nUCLASS()\nclass AMyPlayerController : public APlayerController\n{\n    GENERATED_BODY()\n    \n    UPROPERTY(VisibleAnywhere)\n    UERP_STTComponent* STTComponent;\n    \n    UFUNCTION(Server, Reliable, WithValidation)\n    void ServerExecuteVoiceCommand(const FString& Command, float Confidence);\n    \n    UFUNCTION()\n    void OnTranscriptionReceived(const FERP_STTResult& Result);\n};\n\n// PlayerController.cpp\nvoid AMyPlayerController::BeginPlay()\n{\n    Super::BeginPlay();\n    \n    // Only on owning client\n    if (IsLocalController())\n    {\n        STTComponent->OnTranscriptionComplete.AddDynamic(\n            this, &AMyPlayerController::OnTranscriptionReceived);\n        STTComponent->StartListening();\n    }\n}\n\nvoid AMyPlayerController::OnTranscriptionReceived(const FERP_STTResult& Result)\n{\n    // Client-side: transcribe speech\n    if (Result.Confidence > 0.7f)\n    {\n        // Send text to server\n        ServerExecuteVoiceCommand(Result.TranscribedText, Result.Confidence);\n    }\n}\n\n// Server RPC\nvoid AMyPlayerController::ServerExecuteVoiceCommand_Implementation(\n    const FString& Command, float Confidence)\n{\n    // Server-side: validate and execute\n    if (Command.Contains(TEXT("attack")))\n    {\n        GetPawn()->PerformAttack();\n    }\n    else if (Command.Contains(TEXT("reload")))\n    {\n        GetPawn()->ReloadWeapon();\n    }\n}\n\nbool AMyPlayerController::ServerExecuteVoiceCommand_Validation(\n    const FString& Command, float Confidence)\n{\n    // Prevent abuse: check confidence and length\n    return Confidence > 0.5f && Command.Len() < 256;\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Flow:"})," Microphone \u2192 Audio Capture (client) \u2192 STT (client) \u2192 RPC Text \u2192 Server Validation \u2192 Execute"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"bandwidth-efficiency",children:"Bandwidth Efficiency"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Text vs Audio:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Raw audio: ~1.2 MB/minute (16kHz mono 16-bit)"}),"\n",(0,r.jsx)(n.li,{children:"Transcribed text: ~2 KB/minute (typical speech)"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Reduction: 500x more efficient"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Best Practices:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Always send text, never audio"}),"\n",(0,r.jsx)(n.li,{children:"Compress text with FArchive if sending frequently"}),"\n",(0,r.jsx)(n.li,{children:"Batch multiple commands if possible"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"command-validation",children:"Command Validation"}),"\n",(0,r.jsx)(n.p,{children:"Always validate commands server-side:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool AMyPlayerController::ServerExecuteVoiceCommand_Validation(\n    const FString& Command, float Confidence)\n{\n    // Check confidence threshold\n    if (Confidence < 0.5f) return false;\n    \n    // Check length (prevent spam)\n    if (Command.Len() > 256) return false;\n    \n    // Check rate limit\n    float TimeSinceLastCommand = GetWorld()->GetTimeSeconds() - LastCommandTime;\n    if (TimeSinceLastCommand < 0.5f) return false;\n    \n    LastCommandTime = GetWorld()->GetTimeSeconds();\n    return true;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"anti-cheat",children:"Anti-Cheat"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Never trust client-provided confidence scores for critical actions"}),"\n",(0,r.jsx)(n.li,{children:"Validate all commands match expected patterns"}),"\n",(0,r.jsx)(n.li,{children:"Rate-limit voice commands"}),"\n",(0,r.jsx)(n.li,{children:"Log suspicious activity (e.g., impossible confidence scores, rapid-fire commands)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"npc-dialogue",children:"NPC Dialogue"}),"\n",(0,r.jsx)(n.p,{children:"Server-side LLM for NPC responses:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'// NPC.h (replicated actor)\nUCLASS()\nclass ANPC : public ACharacter\n{\n    GENERATED_BODY()\n    \n    UPROPERTY(VisibleAnywhere)\n    UERP_LLMComponent* LLMComponent;\n    \n    UFUNCTION(Server, Reliable, WithValidation)\n    void ServerSendDialogue(const FString& PlayerMessage);\n    \n    UFUNCTION(NetMulticast, Reliable)\n    void MulticastDisplayResponse(const FString& Response);\n    \n    UFUNCTION()\n    void OnLLMResponse(const FERP_LLMResult& Result);\n};\n\n// NPC.cpp\nvoid ANPC::BeginPlay()\n{\n    Super::BeginPlay();\n    \n    // Only generate dialogue on server\n    if (HasAuthority())\n    {\n        LLMComponent->SetSystemPrompt(TEXT("You are a friendly merchant."));\n        LLMComponent->OnGenerationComplete.AddDynamic(\n            this, &ANPC::OnLLMResponse);\n    }\n}\n\nvoid ANPC::ServerSendDialogue_Implementation(const FString& PlayerMessage)\n{\n    // Generate response on server\n    LLMComponent->SendMessage(PlayerMessage);\n}\n\nvoid ANPC::OnLLMResponse(const FERP_LLMResult& Result)\n{\n    // Broadcast response to all clients\n    MulticastDisplayResponse(Result.GeneratedText);\n}\n\nvoid ANPC::MulticastDisplayResponse_Implementation(const FString& Response)\n{\n    // Display dialogue on all clients\n    ShowDialogueBubble(Response);\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"pattern-1-client-stt--server-processing",children:"Pattern 1: Client STT \u2192 Server Processing"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use for:"})," Voice commands, multiplayer actions\n",(0,r.jsx)(n.strong,{children:"Flow:"})," Client captures \u2192 STT \u2192 Send text \u2192 Server validates \u2192 Execute"]}),"\n",(0,r.jsx)(n.h3,{id:"pattern-2-server-llm--client-display",children:"Pattern 2: Server LLM \u2192 Client Display"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use for:"})," NPC dialogue, quest text\n",(0,r.jsx)(n.strong,{children:"Flow:"})," Server generates \u2192 Multicast text \u2192 All clients display"]}),"\n",(0,r.jsx)(n.h3,{id:"pattern-3-client-stt--client-llm",children:"Pattern 3: Client STT + Client LLM"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use for:"})," Single-player helpers, local UI\n",(0,r.jsx)(n.strong,{children:"Flow:"})," Client captures \u2192 STT \u2192 LLM \u2192 Display (no network)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"testing-multiplayer",children:"Testing Multiplayer"}),"\n",(0,r.jsx)(n.h3,{id:"test-in-editor",children:"Test in Editor"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Enable multiplayer PIE: Editor Preferences \u2192 Play \u2192 Number of Players = 2"}),"\n",(0,r.jsx)(n.li,{children:'Set Net Mode to "Play as Listen Server"'}),"\n",(0,r.jsx)(n.li,{children:"Test with both client and server windows"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"verify-behavior",children:"Verify Behavior"}),"\n",(0,r.jsx)(n.p,{children:"Check logs in both client and server windows:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'// Client log (expected)\nLogElysSTT: Started listening\nLogElysSTT: Transcription: "attack" (0.85)\n\n// Server log (expected)\nLogGame: Received voice command: "attack" (0.85)\nLogGame: Executing attack for Player 1\n\n// Dedicated server log (expected - NO audio)\nLogElysSTT: Warning: STT on dedicated server - disabled\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/ElysGenAIPlugin/Examples",children:"Examples"})})," - See multiplayer examples"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/ElysGenAIPlugin/Troubleshooting",children:"Troubleshooting"})})," - Network-specific issues"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"/ElysGenAIPlugin/CoreConcepts",children:"Core Concepts"})})," - Understand the architecture"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>s,x:()=>o});var l=i(6540);const r={},t=l.createContext(r);function s(e){const n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);