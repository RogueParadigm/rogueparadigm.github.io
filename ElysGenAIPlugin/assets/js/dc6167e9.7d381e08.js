"use strict";(globalThis.webpackChunkelysgenai_docs=globalThis.webpackChunkelysgenai_docs||[]).push([[960],{50(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"MultiplayerGuide","title":"Multiplayer Guide","description":"Designing multiplayer-safe GenAI systems with ElysGenAI.","source":"@site/../Documentation/MultiplayerGuide.md","sourceDirName":".","slug":"/MultiplayerGuide","permalink":"/ElysGenAIPlugin/MultiplayerGuide","draft":false,"unlisted":false,"editUrl":"https://github.com/RogueParadigm/ElysGenAIPlugin/tree/main/Documentation/../Documentation/MultiplayerGuide.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"id":"MultiplayerGuide","title":"Multiplayer Guide","sidebar_position":6},"sidebar":"docsSidebar","previous":{"title":"Hybrid Pattern Explained","permalink":"/ElysGenAIPlugin/HybridPattern"},"next":{"title":"Audio Capture System","permalink":"/ElysGenAIPlugin/AudioCapture"}}');var t=r(4848),l=r(8453);const o={id:"MultiplayerGuide",title:"Multiplayer Guide",sidebar_position:6},s="Multiplayer Guide",a={},d=[{value:"Core Principle",id:"core-principle",level:2},{value:"Architecture Rules",id:"architecture-rules",level:2},{value:"\u2705 What Runs on Client",id:"-what-runs-on-client",level:3},{value:"\u2705 What Runs on Server",id:"-what-runs-on-server",level:3},{value:"\u274c Never Replicate",id:"-never-replicate",level:3},{value:"\u2705 Always Replicate",id:"-always-replicate",level:3},{value:"Network Modes",id:"network-modes",level:2},{value:"Network Mode Reference",id:"network-mode-reference",level:3},{value:"Voice Command Pattern",id:"voice-command-pattern",level:2},{value:"Client-Side Processing",id:"client-side-processing",level:3},{value:"Flow Diagram",id:"flow-diagram",level:3},{value:"NPC Dialogue Pattern",id:"npc-dialogue-pattern",level:2},{value:"Server-Side LLM",id:"server-side-llm",level:3},{value:"Player Asks NPC (Full Flow)",id:"player-asks-npc-full-flow",level:3},{value:"Voice Chat Pattern",id:"voice-chat-pattern",level:2},{value:"Transcription + Audio Streaming",id:"transcription--audio-streaming",level:3},{value:"Bandwidth Considerations",id:"bandwidth-considerations",level:2},{value:"Audio Replication (DON&#39;T DO THIS)",id:"audio-replication-dont-do-this",level:3},{value:"Text Replication (DO THIS)",id:"text-replication-do-this",level:3},{value:"Bandwidth Comparison",id:"bandwidth-comparison",level:3},{value:"Component Replication Setup",id:"component-replication-setup",level:2},{value:"STT Component (Client-Only)",id:"stt-component-client-only",level:3},{value:"LLM Component (Server or Client)",id:"llm-component-server-or-client",level:3},{value:"Example: Multiplayer Voice Commands",id:"example-multiplayer-voice-commands",level:2},{value:"Setup",id:"setup",level:3},{value:"Implementation",id:"implementation",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Validate All Client Input",id:"validate-all-client-input",level:3},{value:"Prevent Replay Attacks",id:"prevent-replay-attacks",level:3},{value:"Testing Multiplayer",id:"testing-multiplayer",level:2},{value:"PIE (Play In Editor) Testing",id:"pie-play-in-editor-testing",level:3},{value:"Dedicated Server Testing",id:"dedicated-server-testing",level:3},{value:"Summary",id:"summary",level:2},{value:"\u2705 Best Practices",id:"-best-practices",level:3},{value:"\u274c Anti-Patterns",id:"-anti-patterns",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"multiplayer-guide",children:"Multiplayer Guide"})}),"\n",(0,t.jsx)(n.p,{children:"Designing multiplayer-safe GenAI systems with ElysGenAI."}),"\n",(0,t.jsx)(n.h2,{id:"core-principle",children:"Core Principle"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"\ud83c\udfaf Audio processing is CLIENT-SIDE ONLY"})}),"\n",(0,t.jsx)(n.p,{children:"Never replicate raw audio over the network. Only replicate text results and metadata."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"architecture-rules",children:"Architecture Rules"}),"\n",(0,t.jsx)(n.h3,{id:"-what-runs-on-client",children:"\u2705 What Runs on Client"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// CLIENT ONLY\r\n- Audio capture (microphone)\r\n- Speech-to-text processing\r\n- LLM generation (for player assistance)\r\n- Voice activity detection\r\n- Audio buffering\n"})}),"\n",(0,t.jsx)(n.h3,{id:"-what-runs-on-server",children:"\u2705 What Runs on Server"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// SERVER\r\n- Text processing (from STT results)\r\n- Intent parsing\r\n- Command validation\r\n- Game state changes\r\n- NPC dialogue generation (LLM)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"-never-replicate",children:"\u274c Never Replicate"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// DO NOT REPLICATE\r\n- Raw audio data (TArray<float>)\r\n- Audio buffers\r\n- Model inference results (internal)\r\n- Backend instances\n"})}),"\n",(0,t.jsx)(n.h3,{id:"-always-replicate",children:"\u2705 Always Replicate"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// DO REPLICATE\r\n- Transcribed text (FString)\r\n- Parsed intents\r\n- Command confirmations\r\n- NPC responses\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"network-modes",children:"Network Modes"}),"\n",(0,t.jsx)(n.p,{children:"Check network mode before processing audio:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'void UERP_STTComponent::BeginPlay()\r\n{\r\n    Super::BeginPlay();\r\n    \r\n    // Only process audio on owning client\r\n    if (GetNetMode() == NM_DedicatedServer)\r\n    {\r\n        UE_LOG(LogElysSTT, Warning, \r\n            TEXT("STT Component on dedicated server - audio capture disabled"));\r\n        return;\r\n    }\r\n    \r\n    if (!GetOwner()->HasAuthority() || GetOwner()->IsLocallyControlled())\r\n    {\r\n        // Safe to capture audio\r\n        StartListening();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"network-mode-reference",children:"Network Mode Reference"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Mode"}),(0,t.jsx)(n.th,{children:"Description"}),(0,t.jsx)(n.th,{children:"Audio Capture?"}),(0,t.jsx)(n.th,{children:"STT?"}),(0,t.jsx)(n.th,{children:"LLM?"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"NM_Standalone"})}),(0,t.jsx)(n.td,{children:"Single player"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"NM_ListenServer"})}),(0,t.jsx)(n.td,{children:"Host + client"}),(0,t.jsx)(n.td,{children:"\u2705 Yes (locally controlled)"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"NM_DedicatedServer"})}),(0,t.jsx)(n.td,{children:"Server only"}),(0,t.jsx)(n.td,{children:"\u274c No"}),(0,t.jsx)(n.td,{children:"\u274c No"}),(0,t.jsx)(n.td,{children:"\u2705 Yes (NPC)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"NM_Client"})}),(0,t.jsx)(n.td,{children:"Connected client"}),(0,t.jsx)(n.td,{children:"\u2705 Yes (locally controlled)"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"voice-command-pattern",children:"Voice Command Pattern"}),"\n",(0,t.jsx)(n.h3,{id:"client-side-processing",children:"Client-Side Processing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'// PlayerController.h\r\nUCLASS()\r\nclass AMyPlayerController : public APlayerController\r\n{\r\n    GENERATED_BODY()\r\n    \r\n    UPROPERTY(VisibleAnywhere)\r\n    UERP_STTComponent* STTComponent;\r\n    \r\n    UFUNCTION(Server, Reliable, WithValidation)\r\n    void ServerExecuteVoiceCommand(const FString& Command, float Confidence);\r\n    \r\n    UFUNCTION()\r\n    void OnTranscriptionReceived(const FElysSTTResult& Result);\r\n};\r\n\r\n// PlayerController.cpp\r\nvoid AMyPlayerController::BeginPlay()\r\n{\r\n    Super::BeginPlay();\r\n    \r\n    // Only on owning client\r\n    if (IsLocalController())\r\n    {\r\n        STTComponent->OnTranscriptionComplete.AddDynamic(\r\n            this, &AMyPlayerController::OnTranscriptionReceived);\r\n        STTComponent->StartListening();\r\n    }\r\n}\r\n\r\nvoid AMyPlayerController::OnTranscriptionReceived(const FElysSTTResult& Result)\r\n{\r\n    // Client-side: transcribe speech\r\n    if (Result.Confidence > 0.7f)\r\n    {\r\n        // Send text to server\r\n        ServerExecuteVoiceCommand(Result.TranscribedText, Result.Confidence);\r\n    }\r\n}\r\n\r\n// Server RPC\r\nvoid AMyPlayerController::ServerExecuteVoiceCommand_Implementation(\r\n    const FString& Command, float Confidence)\r\n{\r\n    // Server-side: validate and execute\r\n    if (Command.Contains(TEXT("attack")))\r\n    {\r\n        GetPawn()->PerformAttack();\r\n    }\r\n    else if (Command.Contains(TEXT("reload")))\r\n    {\r\n        GetPawn()->ReloadWeapon();\r\n    }\r\n}\r\n\r\nbool AMyPlayerController::ServerExecuteVoiceCommand_Validation(\r\n    const FString& Command, float Confidence)\r\n{\r\n    // Prevent abuse\r\n    return Confidence > 0.5f && Command.Len() < 256;\r\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"flow-diagram",children:"Flow Diagram"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"CLIENT\r\n    \u2502\r\n    \u25bc\r\nMicrophone Input\r\n    \u2502\r\n    \u25bc\r\nUERP_AudioCaptureSubsystem\r\n    \u2502\r\n    \u25bc\r\nUERP_STTComponent\r\n    \u2502\r\n    \u25bc\r\nFERP_STTContext (processes audio)\r\n    \u2502\r\n    \u25bc\r\nWhisper.cpp (transcribes)\r\n    \u2502\r\n    \u25bc\r\nOnTranscriptionComplete Event\r\n    \u2502\r\n    \u25bc\r\n[RPC] ServerExecuteVoiceCommand(Text)\r\n    \u2502\r\n    \u2502 (Network)\r\n    \u25bc\r\nSERVER\r\n    \u2502\r\n    \u25bc\r\nValidate Command\r\n    \u2502\r\n    \u25bc\r\nExecute Game Logic\r\n    \u2502\r\n    \u25bc\r\nReplicate State Changes\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"npc-dialogue-pattern",children:"NPC Dialogue Pattern"}),"\n",(0,t.jsx)(n.h3,{id:"server-side-llm",children:"Server-Side LLM"}),"\n",(0,t.jsxs)(n.p,{children:["NPCs should generate dialogue on the ",(0,t.jsx)(n.strong,{children:"server"})," to ensure consistency:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// NPC Character.h\r\nUCLASS()\r\nclass ANPCCharacter : public ACharacter\r\n{\r\n    GENERATED_BODY()\r\n    \r\n    UPROPERTY(VisibleAnywhere)\r\n    UERP_LLMComponent* LLMComponent;\r\n    \r\n    UPROPERTY(ReplicatedUsing=OnRep_CurrentDialogue)\r\n    FString CurrentDialogue;\r\n    \r\n    UFUNCTION()\r\n    void OnRep_CurrentDialogue();\r\n    \r\n    UFUNCTION(NetMulticast, Reliable)\r\n    void MulticastDisplayDialogue(const FString& Dialogue);\r\n    \r\n    void GenerateResponse(const FString& PlayerMessage);\r\n};\r\n\r\n// NPC Character.cpp\r\nvoid ANPCCharacter::BeginPlay()\r\n{\r\n    Super::BeginPlay();\r\n    \r\n    // Only on server\r\n    if (HasAuthority())\r\n    {\r\n        LLMComponent->OnGenerationComplete.AddDynamic(\r\n            this, &ANPCCharacter::OnDialogueGenerated);\r\n    }\r\n}\r\n\r\nvoid ANPCCharacter::GenerateResponse(const FString& PlayerMessage)\r\n{\r\n    if (!HasAuthority()) return;\r\n    \r\n    // Server generates response\r\n    LLMComponent->SendMessage(PlayerMessage);\r\n}\r\n\r\nvoid ANPCCharacter::OnDialogueGenerated(const FElysLLMResult& Result)\r\n{\r\n    CurrentDialogue = Result.GeneratedText;\r\n    \r\n    // Replicate to all clients\r\n    MulticastDisplayDialogue(CurrentDialogue);\r\n}\r\n\r\nvoid ANPCCharacter::MulticastDisplayDialogue_Implementation(const FString& Dialogue)\r\n{\r\n    // All clients display dialogue UI\r\n    ShowDialogueBubble(Dialogue);\r\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"player-asks-npc-full-flow",children:"Player Asks NPC (Full Flow)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'// PlayerController sends voice command to server\r\nvoid AMyPlayerController::OnTranscriptionReceived(const FElysSTTResult& Result)\r\n{\r\n    // Client: "Where is the blacksmith?"\r\n    ServerAskNPC(TargetedNPC, Result.TranscribedText);\r\n}\r\n\r\n// Server receives text, tells NPC to respond\r\nvoid AMyPlayerController::ServerAskNPC_Implementation(ANPCCharacter* NPC, const FString& Question)\r\n{\r\n    if (NPC)\r\n    {\r\n        NPC->GenerateResponse(Question);\r\n    }\r\n}\r\n\r\n// NPC generates response on server\r\nvoid ANPCCharacter::GenerateResponse(const FString& Question)\r\n{\r\n    // Server-side LLM generation\r\n    LLMComponent->SendMessage(Question);\r\n}\r\n\r\n// NPC replicates response to all clients\r\nvoid ANPCCharacter::OnDialogueGenerated(const FElysLLMResult& Result)\r\n{\r\n    MulticastDisplayDialogue(Result.GeneratedText);\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"voice-chat-pattern",children:"Voice Chat Pattern"}),"\n",(0,t.jsx)(n.h3,{id:"transcription--audio-streaming",children:"Transcription + Audio Streaming"}),"\n",(0,t.jsx)(n.p,{children:"Hybrid approach: stream audio for voice chat, but also transcribe for moderation:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// VoiceChatComponent.h\r\nUCLASS()\r\nclass UVoiceChatComponentERP : public UActorComponent, public IERP_AudioConsumer\r\n{\r\n    GENERATED_BODY()\r\n    \r\npublic:\r\n    // IERP_AudioConsumer\r\n    virtual void OnAudioDataReceived_Implementation(const FElysAudioBuffer& Buffer) override;\r\n    \r\n    UPROPERTY(VisibleAnywhere)\r\n    UERP_STTComponent* STTComponent;\r\n    \r\n    UFUNCTION(Server, Unreliable, WithValidation)\r\n    void ServerStreamAudio(const TArray<uint8>& CompressedAudio);\r\n    \r\n    UFUNCTION(Server, Reliable, WithValidation)\r\n    void ServerReportTranscription(const FString& Text, float Confidence);\r\n};\r\n\r\n// VoiceChatComponent.cpp\r\nvoid UVoiceChatComponentERP::OnAudioDataReceived_Implementation(const FElysAudioBuffer& Buffer)\r\n{\r\n    // 1. Stream compressed audio to server (Opus encoding)\r\n    TArray<uint8> CompressedAudio = CompressAudioOpus(Buffer.AudioData);\r\n    ServerStreamAudio(CompressedAudio);\r\n    \r\n    // 2. Also transcribe for moderation (no audio sent)\r\n    STTComponent->ProcessAudioBuffer(Buffer);\r\n}\r\n\r\nvoid UVoiceChatComponentERP::OnTranscriptionComplete(const FElysSTTResult& Result)\r\n{\r\n    // Send transcription to server for content moderation\r\n    ServerReportTranscription(Result.TranscribedText, Result.Confidence);\r\n}\r\n\r\n// Server checks for toxic content\r\nvoid UVoiceChatComponentERP::ServerReportTranscription_Implementation(\r\n    const FString& Text, float Confidence)\r\n{\r\n    if (ContainsToxicContent(Text))\r\n    {\r\n        MutePlayer(GetOwner());\r\n        NotifyModerators(Text);\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"bandwidth-considerations",children:"Bandwidth Considerations"}),"\n",(0,t.jsx)(n.h3,{id:"audio-replication-dont-do-this",children:"Audio Replication (DON'T DO THIS)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// \u274c NEVER DO THIS - Wastes bandwidth\r\nUPROPERTY(Replicated)\r\nTArray<float> AudioBuffer; // 16000 samples/sec * 4 bytes = 64KB/sec\r\n\r\n// \u274c BAD - Replicating raw audio\r\nUFUNCTION(Server, Unreliable)\r\nvoid ServerSendAudio(const TArray<float>& Audio);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"text-replication-do-this",children:"Text Replication (DO THIS)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// \u2705 GOOD - Efficient text replication\r\nUPROPERTY(Replicated)\r\nFString TranscribedText; // ~50 bytes average\r\n\r\n// \u2705 GOOD - Minimal bandwidth\r\nUFUNCTION(Server, Reliable)\r\nvoid ServerSendCommand(const FString& Command);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"bandwidth-comparison",children:"Bandwidth Comparison"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Approach"}),(0,t.jsx)(n.th,{children:"Data Size"}),(0,t.jsx)(n.th,{children:"Frequency"}),(0,t.jsx)(n.th,{children:"Bandwidth"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Raw Audio"})}),(0,t.jsx)(n.td,{children:"64KB/sec"}),(0,t.jsx)(n.td,{children:"Continuous"}),(0,t.jsx)(n.td,{children:"~512 Kbps"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Compressed Audio (Opus)"})}),(0,t.jsx)(n.td,{children:"8KB/sec"}),(0,t.jsx)(n.td,{children:"Continuous"}),(0,t.jsx)(n.td,{children:"~64 Kbps"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Transcribed Text"})}),(0,t.jsx)(n.td,{children:"50 bytes"}),(0,t.jsx)(n.td,{children:"Per sentence"}),(0,t.jsx)(n.td,{children:"~1 Kbps"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Command Text"})}),(0,t.jsx)(n.td,{children:"20 bytes"}),(0,t.jsx)(n.td,{children:"Per command"}),(0,t.jsx)(n.td,{children:"Less than 1 Kbps"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Transcription is 500x more efficient than raw audio!"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"component-replication-setup",children:"Component Replication Setup"}),"\n",(0,t.jsx)(n.h3,{id:"stt-component-client-only",children:"STT Component (Client-Only)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"UCLASS(NotReplicated)\r\nclass UERP_STTComponent : public UActorComponent\r\n{\r\n    // Never replicate STT components\r\n    // Audio processing is purely client-side\r\n};\n"})}),"\n",(0,t.jsx)(n.h3,{id:"llm-component-server-or-client",children:"LLM Component (Server or Client)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"UCLASS()\r\nclass UERP_LLMComponent : public UActorComponent\r\n{\r\n    // Can run on server (NPC dialogue)\r\n    // Or client (player assistance)\r\n    // But generated text can be replicated\r\n    \r\n    UPROPERTY(Replicated)\r\n    FString LastGeneratedText;\r\n};\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"example-multiplayer-voice-commands",children:"Example: Multiplayer Voice Commands"}),"\n",(0,t.jsx)(n.h3,{id:"setup",children:"Setup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// GameMode.h\r\nUCLASS()\r\nclass AMyGameMode : public AGameModeBase\r\n{\r\n    UFUNCTION()\r\n    void HandlePlayerVoiceCommand(APlayerController* Player, const FString& Command);\r\n};\r\n\r\n// PlayerController.h\r\nUCLASS()\r\nclass AMyPlayerController : public APlayerController\r\n{\r\n    UPROPERTY(VisibleAnywhere)\r\n    UERP_STTComponent* STTComponent;\r\n    \r\n    UFUNCTION(Server, Reliable, WithValidation)\r\n    void ServerVoiceCommand(const FString& Command, float Confidence);\r\n};\n"})}),"\n",(0,t.jsx)(n.h3,{id:"implementation",children:"Implementation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'void AMyPlayerController::BeginPlay()\r\n{\r\n    Super::BeginPlay();\r\n    \r\n    if (IsLocalController())\r\n    {\r\n        STTComponent->OnTranscriptionComplete.AddDynamic(\r\n            this, &AMyPlayerController::OnVoiceInput);\r\n        STTComponent->StartListening();\r\n    }\r\n}\r\n\r\nvoid AMyPlayerController::OnVoiceInput(const FElysSTTResult& Result)\r\n{\r\n    // Client processes speech\r\n    if (Result.Confidence > 0.7f)\r\n    {\r\n        // Send text command to server\r\n        ServerVoiceCommand(Result.TranscribedText, Result.Confidence);\r\n        \r\n        // Local feedback\r\n        ClientMessage(FString::Printf(TEXT("You said: %s"), \r\n            *Result.TranscribedText));\r\n    }\r\n}\r\n\r\nvoid AMyPlayerController::ServerVoiceCommand_Implementation(\r\n    const FString& Command, float Confidence)\r\n{\r\n    // Server validates and executes\r\n    AMyGameMode* GM = Cast<AMyGameMode>(GetWorld()->GetAuthGameMode());\r\n    if (GM)\r\n    {\r\n        GM->HandlePlayerVoiceCommand(this, Command);\r\n    }\r\n}\r\n\r\nbool AMyPlayerController::ServerVoiceCommand_Validation(\r\n    const FString& Command, float Confidence)\r\n{\r\n    // Anti-cheat checks\r\n    return Command.Len() > 0 && \r\n           Command.Len() < 256 && \r\n           Confidence >= 0.0f && \r\n           Confidence <= 1.0f;\r\n}\r\n\r\nvoid AMyGameMode::HandlePlayerVoiceCommand(\r\n    APlayerController* Player, const FString& Command)\r\n{\r\n    // Parse and execute command\r\n    if (Command.Contains(TEXT("need ammo")))\r\n    {\r\n        SpawnAmmoNearPlayer(Player);\r\n    }\r\n    else if (Command.Contains(TEXT("regroup")))\r\n    {\r\n        BroadcastRegroupCommand(Player->GetTeamNum());\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,t.jsx)(n.h3,{id:"validate-all-client-input",children:"Validate All Client Input"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'bool AMyPlayerController::ServerVoiceCommand_Validation(\r\n    const FString& Command, float Confidence)\r\n{\r\n    // Length check\r\n    if (Command.Len() > 256) return false;\r\n    \r\n    // Confidence range check\r\n    if (Confidence < 0.0f || Confidence > 1.0f) return false;\r\n    \r\n    // Rate limiting\r\n    float TimeSinceLastCommand = GetWorld()->GetTimeSeconds() - LastCommandTime;\r\n    if (TimeSinceLastCommand < MinCommandInterval) return false;\r\n    \r\n    // Command whitelist (optional)\r\n    static const TArray<FString> AllowedCommands = {\r\n        TEXT("attack"), TEXT("defend"), TEXT("regroup"), TEXT("need ammo")\r\n    };\r\n    \r\n    bool bIsAllowed = false;\r\n    for (const FString& Allowed : AllowedCommands)\r\n    {\r\n        if (Command.Contains(Allowed))\r\n        {\r\n            bIsAllowed = true;\r\n            break;\r\n        }\r\n    }\r\n    \r\n    return bIsAllowed;\r\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"prevent-replay-attacks",children:"Prevent Replay Attacks"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// Add timestamp to commands\r\nUFUNCTION(Server, Reliable, WithValidation)\r\nvoid ServerVoiceCommand(const FString& Command, float Confidence, float Timestamp);\r\n\r\nbool AMyPlayerController::ServerVoiceCommand_Validation(\r\n    const FString& Command, float Confidence, float Timestamp)\r\n{\r\n    // Reject old commands (>1 second)\r\n    float ServerTime = GetWorld()->GetTimeSeconds();\r\n    if (FMath::Abs(ServerTime - Timestamp) > 1.0f) return false;\r\n    \r\n    return true;\r\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"testing-multiplayer",children:"Testing Multiplayer"}),"\n",(0,t.jsx)(n.h3,{id:"pie-play-in-editor-testing",children:"PIE (Play In Editor) Testing"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Editor Preferences \u2192 Play"})}),"\n",(0,t.jsxs)(n.li,{children:["Set ",(0,t.jsx)(n.strong,{children:"Number of Players:"})," 2"]}),"\n",(0,t.jsxs)(n.li,{children:["Set ",(0,t.jsx)(n.strong,{children:"Net Mode:"})," Play As Client"]}),"\n",(0,t.jsxs)(n.li,{children:["Click ",(0,t.jsx)(n.strong,{children:"Play"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Test voice commands on Player 1, verify execution on Player 2's screen."}),"\n",(0,t.jsx)(n.h3,{id:"dedicated-server-testing",children:"Dedicated Server Testing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Launch dedicated server\r\nUE5Editor.exe YourProject.uproject -server -log\r\n\r\n# Launch client\r\nUE5Editor.exe YourProject.uproject 127.0.0.1 -game -log\n"})}),"\n",(0,t.jsx)(n.p,{children:"Check logs for:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"LogElysSTT: Audio capture disabled on dedicated server (expected)\r\nLogNet: Client connected with voice command support\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(n.h3,{id:"-best-practices",children:"\u2705 Best Practices"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Audio processing on ",(0,t.jsx)(n.strong,{children:"client only"})]}),"\n",(0,t.jsxs)(n.li,{children:["Replicate ",(0,t.jsx)(n.strong,{children:"text results"}),", not audio"]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.strong,{children:"Server RPCs"})," for commands"]}),"\n",(0,t.jsxs)(n.li,{children:["Validate ",(0,t.jsx)(n.strong,{children:"all client input"})]}),"\n",(0,t.jsxs)(n.li,{children:["Rate limit ",(0,t.jsx)(n.strong,{children:"command frequency"})]}),"\n",(0,t.jsxs)(n.li,{children:["Check ",(0,t.jsx)(n.strong,{children:"network mode"})," before audio capture"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"-anti-patterns",children:"\u274c Anti-Patterns"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Replicating raw audio buffers"}),"\n",(0,t.jsx)(n.li,{children:"Processing audio on dedicated server"}),"\n",(0,t.jsx)(n.li,{children:"Trusting client-side validation"}),"\n",(0,t.jsx)(n.li,{children:"No rate limiting"}),"\n",(0,t.jsx)(n.li,{children:"Unvalidated text commands"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/ElysGenAIPlugin/STTGuide",children:"STT Guide"})})," - Implement client-side transcription"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/ElysGenAIPlugin/LLMGuide",children:"LLM Guide"})})," - Use LLM for NPC dialogue"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/ElysGenAIPlugin/Examples",children:"Examples"})})," - See full multiplayer examples"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"/ElysGenAIPlugin/AdvancedCustomization",children:"Advanced Customization"})})," - Custom networking patterns"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453(e,n,r){r.d(n,{R:()=>o,x:()=>s});var i=r(6540);const t={},l=i.createContext(t);function o(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);