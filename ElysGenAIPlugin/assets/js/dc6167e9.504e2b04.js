"use strict";(globalThis.webpackChunkelysgenai_docs=globalThis.webpackChunkelysgenai_docs||[]).push([[960],{50(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"MultiplayerGuide","title":"Multiplayer Guide","description":"Designing multiplayer-safe GenAI systems with ElysGenAI.","source":"@site/../Documentation/MultiplayerGuide.md","sourceDirName":".","slug":"/MultiplayerGuide","permalink":"/ElysGenAIPlugin/MultiplayerGuide","draft":false,"unlisted":false,"editUrl":"https://github.com/RogueParadigm/ElysGenAIPlugin/tree/main/Documentation/../Documentation/MultiplayerGuide.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"id":"MultiplayerGuide","title":"Multiplayer Guide","sidebar_position":7},"sidebar":"docsSidebar","previous":{"title":"API Reference","permalink":"/ElysGenAIPlugin/API-Reference"},"next":{"title":"Troubleshooting","permalink":"/ElysGenAIPlugin/Troubleshooting"}}');var l=r(4848),t=r(8453);const s={id:"MultiplayerGuide",title:"Multiplayer Guide",sidebar_position:7},o="Multiplayer Guide",a={},c=[{value:"Core Principle",id:"core-principle",level:2},{value:"Architecture Rules",id:"architecture-rules",level:2},{value:"What Runs on Client",id:"what-runs-on-client",level:3},{value:"What Runs on Server",id:"what-runs-on-server",level:3},{value:"Never Replicate",id:"never-replicate",level:3},{value:"Always Replicate",id:"always-replicate",level:3},{value:"Network Mode Check",id:"network-mode-check",level:2},{value:"Voice Command Pattern",id:"voice-command-pattern",level:2},{value:"Bandwidth Efficiency",id:"bandwidth-efficiency",level:2},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Command Validation",id:"command-validation",level:3},{value:"Anti-Cheat",id:"anti-cheat",level:3},{value:"NPC Dialogue",id:"npc-dialogue",level:2},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Pattern 1: Client STT \u2192 Server Processing",id:"pattern-1-client-stt--server-processing",level:3},{value:"Pattern 2: Server LLM \u2192 Client Display",id:"pattern-2-server-llm--client-display",level:3},{value:"Pattern 3: Client STT + Client LLM",id:"pattern-3-client-stt--client-llm",level:3},{value:"Testing Multiplayer",id:"testing-multiplayer",level:2},{value:"Test in Editor",id:"test-in-editor",level:3},{value:"Verify Behavior",id:"verify-behavior",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"multiplayer-guide",children:"Multiplayer Guide"})}),"\n",(0,l.jsx)(n.p,{children:"Designing multiplayer-safe GenAI systems with ElysGenAI."}),"\n",(0,l.jsx)(n.h2,{id:"core-principle",children:"Core Principle"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Audio processing is CLIENT-SIDE ONLY"})}),"\n",(0,l.jsx)(n.p,{children:"Never replicate raw audio over the network. Only replicate text results and metadata."}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"architecture-rules",children:"Architecture Rules"}),"\n",(0,l.jsx)(n.h3,{id:"what-runs-on-client",children:"What Runs on Client"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Audio capture (microphone)"}),"\n",(0,l.jsx)(n.li,{children:"Speech-to-text processing"}),"\n",(0,l.jsx)(n.li,{children:"LLM generation (for player assistance)"}),"\n",(0,l.jsx)(n.li,{children:"Voice activity detection"}),"\n",(0,l.jsx)(n.li,{children:"Audio buffering"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"what-runs-on-server",children:"What Runs on Server"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Text processing (from STT results)"}),"\n",(0,l.jsx)(n.li,{children:"Intent parsing"}),"\n",(0,l.jsx)(n.li,{children:"Command validation"}),"\n",(0,l.jsx)(n.li,{children:"Game state changes"}),"\n",(0,l.jsx)(n.li,{children:"NPC dialogue generation (LLM)"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"never-replicate",children:"Never Replicate"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Raw audio data (TArray<float>)"}),"\n",(0,l.jsx)(n.li,{children:"Audio buffers"}),"\n",(0,l.jsx)(n.li,{children:"Model inference results (internal)"}),"\n",(0,l.jsx)(n.li,{children:"Backend instances"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"always-replicate",children:"Always Replicate"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Transcribed text (FString)"}),"\n",(0,l.jsx)(n.li,{children:"Parsed intents"}),"\n",(0,l.jsx)(n.li,{children:"Command confirmations"}),"\n",(0,l.jsx)(n.li,{children:"NPC responses"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"network-mode-check",children:"Network Mode Check"}),"\n",(0,l.jsx)(n.p,{children:"Check network mode before processing audio:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:'void UERP_STTComponent::BeginPlay()\r\n{\r\n    Super::BeginPlay();\r\n    \r\n    // Only process audio on owning client\r\n    if (GetNetMode() == NM_DedicatedServer)\r\n    {\r\n        UE_LOG(LogElysSTT, Warning, \r\n            TEXT("STT on dedicated server - disabled"));\r\n        return;\r\n    }\r\n    \r\n    if (!GetOwner()->HasAuthority() || GetOwner()->IsLocallyControlled())\r\n    {\r\n        StartListening();\r\n    }\r\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Network Modes:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"NM_Standalone:"})," Single player - audio capture enabled"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"NM_ListenServer:"})," Host + client - audio capture on locally controlled only"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"NM_DedicatedServer:"})," Server only - NO audio capture"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"NM_Client:"})," Connected client - audio capture on locally controlled only"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"voice-command-pattern",children:"Voice Command Pattern"}),"\n",(0,l.jsx)(n.p,{children:"Complete example showing client-side processing with server validation:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:'// PlayerController.h\r\nUCLASS()\r\nclass AMyPlayerController : public APlayerController\r\n{\r\n    GENERATED_BODY()\r\n    \r\n    UPROPERTY(VisibleAnywhere)\r\n    UERP_STTComponent* STTComponent;\r\n    \r\n    UFUNCTION(Server, Reliable, WithValidation)\r\n    void ServerExecuteVoiceCommand(const FString& Command, float Confidence);\r\n    \r\n    UFUNCTION()\r\n    void OnTranscriptionReceived(const FElysSTTResult& Result);\r\n};\r\n\r\n// PlayerController.cpp\r\nvoid AMyPlayerController::BeginPlay()\r\n{\r\n    Super::BeginPlay();\r\n    \r\n    // Only on owning client\r\n    if (IsLocalController())\r\n    {\r\n        STTComponent->OnTranscriptionComplete.AddDynamic(\r\n            this, &AMyPlayerController::OnTranscriptionReceived);\r\n        STTComponent->StartListening();\r\n    }\r\n}\r\n\r\nvoid AMyPlayerController::OnTranscriptionReceived(const FElysSTTResult& Result)\r\n{\r\n    // Client-side: transcribe speech\r\n    if (Result.Confidence > 0.7f)\r\n    {\r\n        // Send text to server\r\n        ServerExecuteVoiceCommand(Result.TranscribedText, Result.Confidence);\r\n    }\r\n}\r\n\r\n// Server RPC\r\nvoid AMyPlayerController::ServerExecuteVoiceCommand_Implementation(\r\n    const FString& Command, float Confidence)\r\n{\r\n    // Server-side: validate and execute\r\n    if (Command.Contains(TEXT("attack")))\r\n    {\r\n        GetPawn()->PerformAttack();\r\n    }\r\n    else if (Command.Contains(TEXT("reload")))\r\n    {\r\n        GetPawn()->ReloadWeapon();\r\n    }\r\n}\r\n\r\nbool AMyPlayerController::ServerExecuteVoiceCommand_Validation(\r\n    const FString& Command, float Confidence)\r\n{\r\n    // Prevent abuse: check confidence and length\r\n    return Confidence > 0.5f && Command.Len() < 256;\r\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Flow:"})," Microphone \u2192 Audio Capture (client) \u2192 STT (client) \u2192 RPC Text \u2192 Server Validation \u2192 Execute"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"bandwidth-efficiency",children:"Bandwidth Efficiency"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Text vs Audio:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Raw audio: ~1.2 MB/minute (16kHz mono 16-bit)"}),"\n",(0,l.jsx)(n.li,{children:"Transcribed text: ~2 KB/minute (typical speech)"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Reduction: 500x more efficient"})}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Best Practices:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Always send text, never audio"}),"\n",(0,l.jsx)(n.li,{children:"Compress text with FArchive if sending frequently"}),"\n",(0,l.jsx)(n.li,{children:"Batch multiple commands if possible"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,l.jsx)(n.h3,{id:"command-validation",children:"Command Validation"}),"\n",(0,l.jsx)(n.p,{children:"Always validate commands server-side:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:"bool AMyPlayerController::ServerExecuteVoiceCommand_Validation(\r\n    const FString& Command, float Confidence)\r\n{\r\n    // Check confidence threshold\r\n    if (Confidence < 0.5f) return false;\r\n    \r\n    // Check length (prevent spam)\r\n    if (Command.Len() > 256) return false;\r\n    \r\n    // Check rate limit\r\n    float TimeSinceLastCommand = GetWorld()->GetTimeSeconds() - LastCommandTime;\r\n    if (TimeSinceLastCommand < 0.5f) return false;\r\n    \r\n    LastCommandTime = GetWorld()->GetTimeSeconds();\r\n    return true;\r\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"anti-cheat",children:"Anti-Cheat"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Never trust client-provided confidence scores for critical actions"}),"\n",(0,l.jsx)(n.li,{children:"Validate all commands match expected patterns"}),"\n",(0,l.jsx)(n.li,{children:"Rate-limit voice commands"}),"\n",(0,l.jsx)(n.li,{children:"Log suspicious activity (e.g., impossible confidence scores, rapid-fire commands)"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"npc-dialogue",children:"NPC Dialogue"}),"\n",(0,l.jsx)(n.p,{children:"Server-side LLM for NPC responses:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-cpp",children:'// NPC.h (replicated actor)\r\nUCLASS()\r\nclass ANPC : public ACharacter\r\n{\r\n    GENERATED_BODY()\r\n    \r\n    UPROPERTY(VisibleAnywhere)\r\n    UERP_LLMComponent* LLMComponent;\r\n    \r\n    UFUNCTION(Server, Reliable, WithValidation)\r\n    void ServerSendDialogue(const FString& PlayerMessage);\r\n    \r\n    UFUNCTION(NetMulticast, Reliable)\r\n    void MulticastDisplayResponse(const FString& Response);\r\n    \r\n    UFUNCTION()\r\n    void OnLLMResponse(const FElysLLMResult& Result);\r\n};\r\n\r\n// NPC.cpp\r\nvoid ANPC::BeginPlay()\r\n{\r\n    Super::BeginPlay();\r\n    \r\n    // Only generate dialogue on server\r\n    if (HasAuthority())\r\n    {\r\n        LLMComponent->SetSystemPrompt(TEXT("You are a friendly merchant."));\r\n        LLMComponent->OnGenerationComplete.AddDynamic(\r\n            this, &ANPC::OnLLMResponse);\r\n    }\r\n}\r\n\r\nvoid ANPC::ServerSendDialogue_Implementation(const FString& PlayerMessage)\r\n{\r\n    // Generate response on server\r\n    LLMComponent->SendMessage(PlayerMessage);\r\n}\r\n\r\nvoid ANPC::OnLLMResponse(const FElysLLMResult& Result)\r\n{\r\n    // Broadcast response to all clients\r\n    MulticastDisplayResponse(Result.GeneratedText);\r\n}\r\n\r\nvoid ANPC::MulticastDisplayResponse_Implementation(const FString& Response)\r\n{\r\n    // Display dialogue on all clients\r\n    ShowDialogueBubble(Response);\r\n}\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,l.jsx)(n.h3,{id:"pattern-1-client-stt--server-processing",children:"Pattern 1: Client STT \u2192 Server Processing"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use for:"})," Voice commands, multiplayer actions\r\n",(0,l.jsx)(n.strong,{children:"Flow:"})," Client captures \u2192 STT \u2192 Send text \u2192 Server validates \u2192 Execute"]}),"\n",(0,l.jsx)(n.h3,{id:"pattern-2-server-llm--client-display",children:"Pattern 2: Server LLM \u2192 Client Display"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use for:"})," NPC dialogue, quest text\r\n",(0,l.jsx)(n.strong,{children:"Flow:"})," Server generates \u2192 Multicast text \u2192 All clients display"]}),"\n",(0,l.jsx)(n.h3,{id:"pattern-3-client-stt--client-llm",children:"Pattern 3: Client STT + Client LLM"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use for:"})," Single-player helpers, local UI\r\n",(0,l.jsx)(n.strong,{children:"Flow:"})," Client captures \u2192 STT \u2192 LLM \u2192 Display (no network)"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"testing-multiplayer",children:"Testing Multiplayer"}),"\n",(0,l.jsx)(n.h3,{id:"test-in-editor",children:"Test in Editor"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Enable multiplayer PIE: Editor Preferences \u2192 Play \u2192 Number of Players = 2"}),"\n",(0,l.jsx)(n.li,{children:'Set Net Mode to "Play as Listen Server"'}),"\n",(0,l.jsx)(n.li,{children:"Test with both client and server windows"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"verify-behavior",children:"Verify Behavior"}),"\n",(0,l.jsx)(n.p,{children:"Check logs in both client and server windows:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'// Client log (expected)\r\nLogElysSTT: Started listening\r\nLogElysSTT: Transcription: "attack" (0.85)\r\n\r\n// Server log (expected)\r\nLogGame: Received voice command: "attack" (0.85)\r\nLogGame: Executing attack for Player 1\r\n\r\n// Dedicated server log (expected - NO audio)\r\nLogElysSTT: Warning: STT on dedicated server - disabled\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/ElysGenAIPlugin/Examples",children:"Examples"})})," - See multiplayer examples"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/ElysGenAIPlugin/Troubleshooting",children:"Troubleshooting"})})," - Network-specific issues"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:(0,l.jsx)(n.a,{href:"/ElysGenAIPlugin/CoreConcepts",children:"Core Concepts"})})," - Understand the architecture"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>s,x:()=>o});var i=r(6540);const l={},t=i.createContext(l);function s(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);