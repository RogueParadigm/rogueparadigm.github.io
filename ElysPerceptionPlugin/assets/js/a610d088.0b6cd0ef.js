"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[769],{8453(e,n,r){r.d(n,{R:()=>l,x:()=>o});var t=r(6540);const i={},s=t.createContext(i);function l(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(s.Provider,{value:n},e.children)}},8701(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"Customization","title":"Customization Guide","description":"Create custom pipeline components and extend ElysPerceptionPlugin for advanced use cases.","source":"@site/../Documentation/Customization.md","sourceDirName":".","slug":"/Customization","permalink":"/ElysPerceptionPlugin/Customization","draft":false,"unlisted":false,"editUrl":"https://github.com/RogueParadigm/ElysPerceptionPlugin/tree/main/Documentation/../Documentation/Customization.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"id":"Customization","title":"Customization Guide","sidebar_position":8},"sidebar":"docsSidebar","previous":{"title":"Widget Guide","permalink":"/ElysPerceptionPlugin/WidgetGuide"},"next":{"title":"API Reference","permalink":"/ElysPerceptionPlugin/API-Reference"}}');var i=r(4848),s=r(8453);const l={id:"Customization",title:"Customization Guide",sidebar_position:8},o=void 0,a={},c=[{value:"When to Customize",id:"when-to-customize",level:2},{value:"Extension Points",id:"extension-points",level:2},{value:"Custom Samplers",id:"custom-samplers",level:2},{value:"Purpose",id:"purpose",level:3},{value:"Interface",id:"interface",level:3},{value:"C++ Example: Line Trace Sampler",id:"c-example-line-trace-sampler",level:3},{value:"Custom Filters",id:"custom-filters",level:2},{value:"Purpose",id:"purpose-1",level:3},{value:"Interface",id:"interface-1",level:3},{value:"C++ Example: Line of Sight Filter",id:"c-example-line-of-sight-filter",level:3},{value:"Custom Scorers",id:"custom-scorers",level:2},{value:"Purpose",id:"purpose-2",level:3},{value:"Interface",id:"interface-2",level:3},{value:"C++ Example: Health Priority Scorer",id:"c-example-health-priority-scorer",level:3},{value:"Using Weights",id:"using-weights",level:3},{value:"Custom Aggregators",id:"custom-aggregators",level:2},{value:"Purpose",id:"purpose-3",level:3},{value:"Interface",id:"interface-3",level:3},{value:"C++ Example: Min Aggregator",id:"c-example-min-aggregator",level:3},{value:"Custom Resolvers",id:"custom-resolvers",level:2},{value:"Purpose",id:"purpose-4",level:3},{value:"Interface",id:"interface-4",level:3},{value:"C++ Example: Sticky Target Resolver",id:"c-example-sticky-target-resolver",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Create custom pipeline components and extend ElysPerceptionPlugin for advanced use cases."}),"\n",(0,i.jsx)(n.h2,{id:"when-to-customize",children:"When to Customize"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Pipeline components"})," (samplers, filters, scorers, aggregators, resolvers): when default components don't fit your needs."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Domain components"}),": when you need a new gameplay system that reacts to perception. See ",(0,i.jsx)(n.a,{href:"/ElysPerceptionPlugin/CustomDomains",children:"Custom Domains"})," for a dedicated guide."]}),"\n",(0,i.jsx)(n.h2,{id:"extension-points",children:"Extension Points"}),"\n",(0,i.jsx)(n.p,{children:"Each pipeline stage has an abstract base class you can extend in Blueprint or C++:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"UERPSamplerBase"})," - Custom candidate gathering"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"UERPFilterBase"})," - Custom filtering logic"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"UERPScorerBase"})," - Custom scoring logic"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"UERPAggregatorBase"})," - Custom score combination"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"UERPResolverBase"})," - Custom winner selection"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"custom-samplers",children:"Custom Samplers"}),"\n",(0,i.jsx)(n.h3,{id:"purpose",children:"Purpose"}),"\n",(0,i.jsx)(n.p,{children:"Samplers gather potential candidates. Customize when you need:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Different spatial queries (raycast, box overlap)"}),"\n",(0,i.jsx)(n.li,{children:"Non-spatial queries (GameState actor lists)"}),"\n",(0,i.jsx)(n.li,{children:"Cached/optimized candidate lists"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"interface",children:"Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'UFUNCTION(BlueprintNativeEvent, Category = "ElysPerception|Pipeline")\r\nvoid Sample(const FERPPerceptionContext& Context, float Range, TArray<AActor*>& OutCandidates) const;\n'})}),"\n",(0,i.jsx)(n.h3,{id:"c-example-line-trace-sampler",children:"C++ Example: Line Trace Sampler"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"UCLASS(Blueprintable, EditInlineNew, DefaultToInstanced)\r\nclass YOURGAME_API UERPLineTraceSampler : public UERPSamplerBase\r\n{\r\n    GENERATED_BODY()\r\npublic:\r\n    UPROPERTY(EditAnywhere) TEnumAsByte<ECollisionChannel> TraceChannel = ECC_Visibility;\r\n\r\n    virtual void Sample_Implementation(const FERPPerceptionContext& Context, float Range,\r\n        TArray<AActor*>& OutCandidates) const override\r\n    {\r\n        if (!Context.ContextActor) return;\r\n        UWorld* World = Context.ContextActor->GetWorld();\r\n        if (!World) return;\r\n\r\n        FCollisionQueryParams Params;\r\n        Params.AddIgnoredActor(Context.ContextActor);\r\n\r\n        FHitResult Hit;\r\n        if (World->LineTraceSingleByChannel(Hit, Context.Origin,\r\n            Context.Origin + Context.Forward * Range, TraceChannel, Params))\r\n        {\r\n            if (AActor* A = Hit.GetActor()) OutCandidates.Add(A);\r\n        }\r\n    }\r\n};\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"custom-filters",children:"Custom Filters"}),"\n",(0,i.jsx)(n.h3,{id:"purpose-1",children:"Purpose"}),"\n",(0,i.jsx)(n.p,{children:"Filters reject invalid candidates. Customize for:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Line of sight checks"}),"\n",(0,i.jsx)(n.li,{children:"Team/faction filtering"}),"\n",(0,i.jsx)(n.li,{children:"State validation (alive, active)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"interface-1",children:"Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'UFUNCTION(BlueprintNativeEvent, Category = "ElysPerception|Pipeline")\r\nbool Passes(const FERPPerceptionContext& Context, AActor* Candidate) const;\n'})}),"\n",(0,i.jsx)(n.h3,{id:"c-example-line-of-sight-filter",children:"C++ Example: Line of Sight Filter"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"UCLASS(Blueprintable, EditInlineNew, DefaultToInstanced)\r\nclass YOURGAME_API UERPLineOfSightFilter : public UERPFilterBase\r\n{\r\n    GENERATED_BODY()\r\npublic:\r\n    UPROPERTY(EditAnywhere) TEnumAsByte<ECollisionChannel> TraceChannel = ECC_Visibility;\r\n\r\n    virtual bool Passes_Implementation(const FERPPerceptionContext& Context,\r\n        AActor* Candidate) const override\r\n    {\r\n        if (!Context.ContextActor || !Candidate) return false;\r\n        UWorld* World = Context.ContextActor->GetWorld();\r\n        if (!World) return false;\r\n\r\n        FCollisionQueryParams Params;\r\n        Params.AddIgnoredActor(Context.ContextActor);\r\n        Params.AddIgnoredActor(Candidate);\r\n\r\n        FHitResult Hit;\r\n        bool bHit = World->LineTraceSingleByChannel(Hit, Context.Origin,\r\n            Candidate->GetActorLocation(), TraceChannel, Params);\r\n        return !bHit;\r\n    }\r\n};\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"custom-scorers",children:"Custom Scorers"}),"\n",(0,i.jsx)(n.h3,{id:"purpose-2",children:"Purpose"}),"\n",(0,i.jsxs)(n.p,{children:["Scorers assign numerical values. Each scorer is paired with a weight in the pipeline configuration (",(0,i.jsx)(n.code,{children:"FERPScorerEntry"}),")."]}),"\n",(0,i.jsx)(n.h3,{id:"interface-2",children:"Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'UFUNCTION(BlueprintNativeEvent, Category = "ElysPerception|Pipeline")\r\nfloat Score(const FERPPerceptionContext& Context, AActor* Candidate) const;\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Convention:"})," Lower score = better. Return ",(0,i.jsx)(n.code,{children:"ERPPipelineScore::RejectScore"})," to reject."]}),"\n",(0,i.jsx)(n.h3,{id:"c-example-health-priority-scorer",children:"C++ Example: Health Priority Scorer"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"UCLASS(Blueprintable, EditInlineNew, DefaultToInstanced)\r\nclass YOURGAME_API UERPHealthScorer : public UERPScorerBase\r\n{\r\n    GENERATED_BODY()\r\npublic:\r\n    UPROPERTY(EditAnywhere) bool bPrioritizeLowHealth = true;\r\n\r\n    virtual float Score_Implementation(const FERPPerceptionContext& Context,\r\n        AActor* Candidate) const override\r\n    {\r\n        UHealthComponent* HC = Candidate->FindComponentByClass<UHealthComponent>();\r\n        if (!HC) return 1.0f;\r\n        float HP = HC->GetHealthPercent();\r\n        return bPrioritizeLowHealth ? HP : (1.0f - HP);\r\n    }\r\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"using-weights",children:"Using Weights"}),"\n",(0,i.jsx)(n.p,{children:"Configure in the pipeline:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Scorers:\r\n  - ERPDistanceScorer, Weight: 2.0    (distance matters more)\r\n  - ERPHealthScorer,   Weight: 1.0    (health is secondary)\r\n  - ERPConeScorer,     Weight: 0.5    (angle is tertiary)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Each raw score is multiplied by its weight before aggregation."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"custom-aggregators",children:"Custom Aggregators"}),"\n",(0,i.jsx)(n.h3,{id:"purpose-3",children:"Purpose"}),"\n",(0,i.jsx)(n.p,{children:"Aggregators combine weighted scores. The default sums them."}),"\n",(0,i.jsx)(n.h3,{id:"interface-3",children:"Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'UFUNCTION(BlueprintNativeEvent, Category = "ElysPerception|Pipeline")\r\nfloat Aggregate(const TArray<float>& Scores) const;\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Note: The ",(0,i.jsx)(n.code,{children:"Scores"})," array contains already-weighted values."]}),"\n",(0,i.jsx)(n.h3,{id:"c-example-min-aggregator",children:"C++ Example: Min Aggregator"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"UCLASS(Blueprintable, EditInlineNew, DefaultToInstanced)\r\nclass YOURGAME_API UERPMinAggregator : public UERPAggregatorBase\r\n{\r\n    GENERATED_BODY()\r\npublic:\r\n    virtual float Aggregate_Implementation(const TArray<float>& Scores) const override\r\n    {\r\n        float Min = TNumericLimits<float>::Max();\r\n        for (float S : Scores) Min = FMath::Min(Min, S);\r\n        return (Min == TNumericLimits<float>::Max()) ? 0.f : Min;\r\n    }\r\n};\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"custom-resolvers",children:"Custom Resolvers"}),"\n",(0,i.jsx)(n.h3,{id:"purpose-4",children:"Purpose"}),"\n",(0,i.jsx)(n.p,{children:"Resolvers select the winner. The default picks lowest score."}),"\n",(0,i.jsx)(n.h3,{id:"interface-4",children:"Interface"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'UFUNCTION(BlueprintNativeEvent, Category = "ElysPerception|Pipeline")\r\nbool Resolve(const TArray<FERPPipelineScoredCandidate>& ScoredCandidates,\r\n    FERPPipelineScoredCandidate& OutBest) const;\n'})}),"\n",(0,i.jsx)(n.h3,{id:"c-example-sticky-target-resolver",children:"C++ Example: Sticky Target Resolver"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:"UCLASS(Blueprintable, EditInlineNew, DefaultToInstanced)\r\nclass YOURGAME_API UERPStickyResolver : public UERPResolverBase\r\n{\r\n    GENERATED_BODY()\r\npublic:\r\n    UPROPERTY(EditAnywhere) float StickyBias = 0.1f;\r\n    UPROPERTY() mutable TWeakObjectPtr<AActor> LastWinner;\r\n\r\n    virtual bool Resolve_Implementation(\r\n        const TArray<FERPPipelineScoredCandidate>& ScoredCandidates,\r\n        FERPPipelineScoredCandidate& OutBest) const override\r\n    {\r\n        if (ScoredCandidates.Num() == 0) return false;\r\n        OutBest = ScoredCandidates[0];\r\n        for (const auto& C : ScoredCandidates)\r\n        {\r\n            float Adjusted = C.Score;\r\n            if (C.Actor == LastWinner.Get()) Adjusted -= StickyBias;\r\n            if (Adjusted < OutBest.Score) OutBest = C;\r\n        }\r\n        LastWinner = OutBest.Actor;\r\n        return true;\r\n    }\r\n};\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Keep Stages Pure:"})," Don't modify candidates or context"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Normalize Scores:"})," Use 0.0-1.0 range when possible"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Handle Edge Cases:"})," Null checks, empty arrays, invalid context"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Optimize:"})," Filters run per-candidate, keep fast. Cache expensive calculations."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Document Parameters:"})," Use UPROPERTY meta tags and tooltips"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.p,{children:["Create custom domains with ",(0,i.jsx)(n.a,{href:"/ElysPerceptionPlugin/CustomDomains",children:"Custom Domains"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Check complete API in ",(0,i.jsx)(n.a,{href:"/ElysPerceptionPlugin/API-Reference",children:"API Reference"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/ElysPerceptionPlugin/Quick-Reference",children:"Quick Reference"})," for cheat sheet."]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);