"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[205],{1510(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"CustomDomains","title":"Custom Domains","description":"Create your own perception domains by extending UERPDomainComponent.","source":"@site/../Documentation/CustomDomains.md","sourceDirName":".","slug":"/CustomDomains","permalink":"/ElysPerceptionPlugin/CustomDomains","draft":false,"unlisted":false,"editUrl":"https://github.com/RogueParadigm/ElysPerceptionPlugin/tree/main/Documentation/../Documentation/CustomDomains.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"id":"CustomDomains","title":"Custom Domains","sidebar_position":6},"sidebar":"docsSidebar","previous":{"title":"Targeting Guide","permalink":"/ElysPerceptionPlugin/TargetingGuide"},"next":{"title":"Widget Guide","permalink":"/ElysPerceptionPlugin/WidgetGuide"}}');var r=t(4848),l=t(8453);const d={id:"CustomDomains",title:"Custom Domains",sidebar_position:6},s=void 0,a={},o=[{value:"Overview",id:"overview",level:2},{value:"UERPDomainComponent Base Class",id:"uerpdomaincomponent-base-class",level:2},{value:"Blueprint Tutorial: Loot Highlighting Domain",id:"blueprint-tutorial-loot-highlighting-domain",level:2},{value:"Step 1: Create Blueprint Class",id:"step-1-create-blueprint-class",level:3},{value:"Step 2: Configure Defaults",id:"step-2-configure-defaults",level:3},{value:"Step 3: Override IsCandidateEligible",id:"step-3-override-iscandidateeligible",level:3},{value:"Step 4: Override HandleCandidateUpdated",id:"step-4-override-handlecandidateupdated",level:3},{value:"Step 5: Configure Perception Pipeline",id:"step-5-configure-perception-pipeline",level:3},{value:"C++ Tutorial: Stealth Detection Domain",id:"c-tutorial-stealth-detection-domain",level:2},{value:"Step 1: Create Header",id:"step-1-create-header",level:3},{value:"Step 2: Create Implementation",id:"step-2-create-implementation",level:3},{value:"Step 3: Use It",id:"step-3-use-it",level:3},{value:"Base Class API",id:"base-class-api",level:2},{value:"Properties",id:"properties",level:3},{value:"Events",id:"events",level:3},{value:"Methods",id:"methods",level:3},{value:"Virtual Hooks",id:"virtual-hooks",level:3},{value:"Tips",id:"tips",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Create your own perception domains by extending ",(0,r.jsx)(n.code,{children:"UERPDomainComponent"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:'A "domain" is a gameplay interpretation of perception data. The plugin ships with two built-in domains:'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Interaction"})," (",(0,r.jsx)(n.code,{children:"UERPInteractionComponent"}),") - proximity interactions with RPC support"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Targeting"})," (",(0,r.jsx)(n.code,{children:"UERPTargetingComponent"}),") - combat targeting with descriptor tracking"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"You can create additional domains for any gameplay system that needs to react to perception candidates: stealth detection, loot highlighting, dialogue triggers, quest markers, etc."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"uerpdomaincomponent-base-class",children:"UERPDomainComponent Base Class"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"UERPDomainComponent"})," handles all the shared boilerplate:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Auto-finds ",(0,r.jsx)(n.code,{children:"UERPPerceptionComponent"})," on the owner at BeginPlay"]}),"\n",(0,r.jsxs)(n.li,{children:["Binds to ",(0,r.jsx)(n.code,{children:"OnChannelCandidateAcquired"})," / ",(0,r.jsx)(n.code,{children:"OnChannelCandidateLost"})]}),"\n",(0,r.jsxs)(n.li,{children:["Filters by ",(0,r.jsx)(n.code,{children:"ChannelId"})]}),"\n",(0,r.jsxs)(n.li,{children:["Tracks ",(0,r.jsx)(n.code,{children:"CurrentCandidate"})," with change detection"]}),"\n",(0,r.jsxs)(n.li,{children:["Broadcasts ",(0,r.jsx)(n.code,{children:"OnDomainCandidateChanged(Previous, New, ChannelId)"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Your subclass only needs to override two virtual hooks:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"IsCandidateEligible(AActor*)"})," - return false to reject candidates"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"HandleCandidateUpdated(Previous, Current)"})," - react to candidate changes"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Both are ",(0,r.jsx)(n.code,{children:"BlueprintNativeEvent"}),", so you can override in C++ or Blueprint."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"blueprint-tutorial-loot-highlighting-domain",children:"Blueprint Tutorial: Loot Highlighting Domain"}),"\n",(0,r.jsx)(n.h3,{id:"step-1-create-blueprint-class",children:"Step 1: Create Blueprint Class"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Content Browser -> New Blueprint Class"}),"\n",(0,r.jsxs)(n.li,{children:["Parent Class: ",(0,r.jsx)(n.code,{children:"ERPDomainComponent"})]}),"\n",(0,r.jsxs)(n.li,{children:["Name: ",(0,r.jsx)(n.code,{children:"BP_LootDomainComponent"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-2-configure-defaults",children:"Step 2: Configure Defaults"}),"\n",(0,r.jsx)(n.p,{children:"In the Class Defaults:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Channel Id: ",(0,r.jsx)(n.code,{children:"Loot"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"step-3-override-iscandidateeligible",children:"Step 3: Override IsCandidateEligible"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Override ",(0,r.jsx)(n.code,{children:"IsCandidateEligible"})]}),"\n",(0,r.jsx)(n.li,{children:"Logic:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Function: Is Candidate Eligible (Candidate)\r\n  -> Does Implement Interface: ILootable (your interface)\r\n  -> Branch:\r\n    True: -> Cast to ILootable -> Can Be Looted?\r\n           -> Return result\r\n    False: -> Return false\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-4-override-handlecandidateupdated",children:"Step 4: Override HandleCandidateUpdated"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Override ",(0,r.jsx)(n.code,{children:"HandleCandidateUpdated"})]}),"\n",(0,r.jsx)(n.li,{children:"Logic:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Function: Handle Candidate Updated (Previous, Current)\r\n  // Unhighlight previous\r\n  -> Branch: IsValid(Previous)\r\n    True: -> Previous -> SetRenderCustomDepth(false)\r\n\r\n  // Highlight current\r\n  -> Branch: IsValid(Current)\r\n    True: -> Current -> SetRenderCustomDepth(true)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"step-5-configure-perception-pipeline",children:"Step 5: Configure Perception Pipeline"}),"\n",(0,r.jsx)(n.p,{children:"On your PlayerController or Pawn:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Add a channel pipeline to ",(0,r.jsx)(n.code,{children:"ERPPerceptionComponent"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Channel Id: ",(0,r.jsx)(n.code,{children:"Loot"})]}),"\n",(0,r.jsxs)(n.li,{children:["Sampler: ",(0,r.jsx)(n.code,{children:"ERPSphereOverlapSampler"})," (range: 500)"]}),"\n",(0,r.jsx)(n.li,{children:"Filter: Your custom loot filter (or none)"}),"\n",(0,r.jsxs)(n.li,{children:["Scorer: ",(0,r.jsx)(n.code,{children:"ERPDistanceScorer"})]}),"\n",(0,r.jsxs)(n.li,{children:["Resolver: ",(0,r.jsx)(n.code,{children:"ERPResolverBase"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Add ",(0,r.jsx)(n.code,{children:"BP_LootDomainComponent"})," to the same actor"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Channel Id: ",(0,r.jsx)(n.code,{children:"Loot"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"c-tutorial-stealth-detection-domain",children:"C++ Tutorial: Stealth Detection Domain"}),"\n",(0,r.jsx)(n.h3,{id:"step-1-create-header",children:"Step 1: Create Header"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#pragma once\r\n\r\n#include "CoreMinimal.h"\r\n#include "Core/ERPDomainComponent.h"\r\n#include "ERPStealthDomainComponent.generated.h"\r\n\r\nDECLARE_DYNAMIC_MULTICAST_DELEGATE_TwoParams(\r\n    FOnStealthTargetChanged,\r\n    AActor*, PreviousTarget,\r\n    AActor*, NewTarget);\r\n\r\nUCLASS(ClassGroup=(Custom), Blueprintable, meta=(BlueprintSpawnableComponent))\r\nclass YOURGAME_API UERPStealthDomainComponent : public UERPDomainComponent\r\n{\r\n    GENERATED_BODY()\r\n\r\npublic:\r\n    UERPStealthDomainComponent();\r\n\r\n    UPROPERTY(BlueprintAssignable, Category = "Stealth")\r\n    FOnStealthTargetChanged OnStealthTargetChanged;\r\n\r\n    UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Stealth")\r\n    float MinAwarenessToDetect = 0.5f;\r\n\r\nprotected:\r\n    virtual bool IsCandidateEligible_Implementation(AActor* Candidate) const override;\r\n    virtual void HandleCandidateUpdated_Implementation(AActor* Previous, AActor* Current) override;\r\n};\n'})}),"\n",(0,r.jsx)(n.h3,{id:"step-2-create-implementation",children:"Step 2: Create Implementation"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include "ERPStealthDomainComponent.h"\r\n#include "YourStealthInterface.h"\r\n\r\nUERPStealthDomainComponent::UERPStealthDomainComponent()\r\n{\r\n    ChannelId = FName("Stealth");\r\n}\r\n\r\nbool UERPStealthDomainComponent::IsCandidateEligible_Implementation(AActor* Candidate) const\r\n{\r\n    if (!Candidate || !GetOwner())\r\n    {\r\n        return false;\r\n    }\r\n\r\n    // Check if candidate implements your stealth interface\r\n    if (!Candidate->GetClass()->ImplementsInterface(UYourStealthInterface::StaticClass()))\r\n    {\r\n        return false;\r\n    }\r\n\r\n    // Check awareness level\r\n    float Awareness = IYourStealthInterface::Execute_GetAwarenessLevel(Candidate, GetOwner());\r\n    return Awareness >= MinAwarenessToDetect;\r\n}\r\n\r\nvoid UERPStealthDomainComponent::HandleCandidateUpdated_Implementation(AActor* Previous, AActor* Current)\r\n{\r\n    OnStealthTargetChanged.Broadcast(Previous, Current);\r\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"step-3-use-it",children:"Step 3: Use It"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'// In your PlayerController\r\nStealthDomain = CreateDefaultSubobject<UERPStealthDomainComponent>(TEXT("StealthDomain"));\r\n// ChannelId defaults to "Stealth"\r\n\r\n// Bind events\r\nStealthDomain->OnStealthTargetChanged.AddDynamic(this, &AMyPC::OnStealthDetection);\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"base-class-api",children:"Base Class API"}),"\n",(0,r.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"PerceptionComponent"})}),(0,r.jsx)(n.td,{children:"UERPPerceptionComponent*"}),(0,r.jsx)(n.td,{children:"Auto-found on owner at BeginPlay"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ChannelId"})}),(0,r.jsx)(n.td,{children:"FName"}),(0,r.jsx)(n.td,{children:"Perception channel to listen to"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"events",children:"Events"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Event"}),(0,r.jsx)(n.th,{children:"Signature"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"OnDomainCandidateChanged"})}),(0,r.jsx)(n.td,{children:"(Previous, New, ChannelId)"}),(0,r.jsx)(n.td,{children:"Candidate changed"})]})})]}),"\n",(0,r.jsx)(n.h3,{id:"methods",children:"Methods"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Method"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GetCurrentCandidate()"})}),(0,r.jsx)(n.td,{children:"Returns current candidate (or nullptr)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"HasCandidate()"})}),(0,r.jsx)(n.td,{children:"True if a candidate is active"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"SetCandidate(AActor*)"})}),(0,r.jsx)(n.td,{children:"Manually set candidate (validates eligibility)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ClearCandidate()"})}),(0,r.jsx)(n.td,{children:"Clear current candidate"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"virtual-hooks",children:"Virtual Hooks"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Hook"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"IsCandidateEligible(AActor*)"})}),(0,r.jsx)(n.td,{children:"Returns true"}),(0,r.jsx)(n.td,{children:"Override to add validation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"HandleCandidateUpdated(Previous, Current)"})}),(0,r.jsx)(n.td,{children:"No-op"}),(0,r.jsx)(n.td,{children:"Override to react to changes"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Keep ",(0,r.jsx)(n.code,{children:"IsCandidateEligible"})," lightweight - it runs on every perception event"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"HandleCandidateUpdated"})," for heavier operations (resolve descriptors, update UI)"]}),"\n",(0,r.jsx)(n.li,{children:"Domain components don't tick - they react to perception events only"}),"\n",(0,r.jsx)(n.li,{children:"You can have multiple domain components listening to different channels on the same actor"}),"\n",(0,r.jsx)(n.li,{children:"The base class handles null checks and same-candidate detection for you"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.p,{children:["Learn about pipeline customization in ",(0,r.jsx)(n.a,{href:"/ElysPerceptionPlugin/Customization",children:"Customization"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Check complete API in ",(0,r.jsx)(n.a,{href:"/ElysPerceptionPlugin/API-Reference",children:"API Reference"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453(e,n,t){t.d(n,{R:()=>d,x:()=>s});var i=t(6540);const r={},l=i.createContext(r);function d(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);